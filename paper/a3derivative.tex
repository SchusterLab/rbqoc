\section{Derivative Method \label{appendix:derivative}}
Here, we outline how to efficiently integrate the dynamics
for the derivative method using exponential integrators.
General exponential integrators break the dynamics into a linear term and a non-linear term.
For example, the dynamics for the first state derivative
are $\frac{d}{dt} \ket{\partial_{\lambda} \psi} =
-\frac{i}{\hbar} H  \ket{\partial_{\lambda} \psi} -
\frac{i}{\hbar} (\partial_{\lambda} H) \ket{\psi}$.
The linear term is $L = -\frac{i}{\hbar} H$ and the non-linear
term is $N = -\frac{i}{\hbar} (\partial_{\lambda} H) \ket{\psi}$.
With zero-order hold on the controls the exact solution is:
\begin{equation}
  \label{eq:dgeneralexp}
  \begin{aligned}
    \ket{\partial_{\lambda} \psi_{k + 1}} &= \exp(\Delta t_{k} L_{k})
    \ket{\partial_{\lambda} \psi_{k}}\\
    &+ \int_{0}^{\Delta t_{k}} \exp((\Delta t_{k} - t^{'})L_{k})
    N(t_{k} + t^{'}) dt^{'}.\\
  \end{aligned}
\end{equation}
General exponential integrators proceed by breaking the integral in \eqref{eq:dgeneralexp}
into a discrete sum, similar to the procedure
for Runge-Kutta schemes. We use a simple approximation known as the Lawson-Euler
method \cite{berland2005solving},
\begin{equation}
  \begin{aligned}
    \ket{\partial_{\lambda} \psi_{k + 1}} &\approx \exp(\Delta t_{k}L_{k})
    \ket{\partial_{\lambda} \psi_{k}}\\
    &+ \exp(\Delta t_{k}L_{k}) N_{k} \Delta t_{k}.\\
  \end{aligned}
\end{equation}
This method provides a good tradeoff between accuracy and efficiency, requiring one unique matrix
exponential computation per stage. Integration accuracy is not of the utmost importance because the
state derivatives guide the optimization, and do not correspond to experimental parameters
which must be realized with high accuracy.




