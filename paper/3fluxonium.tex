\section{QOC on the Fluxonium \label{sec:fluxonium}}
In the following we study
the quantum optimal control problem on the fluxonium qubit.
The fluxonium qubit is a promising building block for superconducting
circuits, and the experimental constraints we encode in the optimization reflect
those of a realistic device. Furthermore, the accurate
two-level approximation of the system Hamiltonian makes it
efficient to perform quantum optimal control on
a classical computer. In the two-level
approximation the system Hamiltonian takes the form:
\begin{align}
  H/h &= f_{q} \frac{\sigma_{z}}{2} + a(t) \frac{\sigma_{x}}{2}
  \label{eq:hamiltonian}
\end{align}
where $f_{q} = 14$MHz is the qubit frequency at the flux frustration point,
$a$ is the flux drive amplitude, $h$ is Planck's constant, and $\sigma_{x}, \sigma_{y}$
are Pauli matrices. The flux amplitude $a$ is experimentally
realized by modulating the flux 
threading the device. We consider the task of constructing $Z/2$, $Y/2$, and $X/2$
gates for the fluxonium qubit subject to experimental constraints, decoherence, and
systematic errors. We compare the gates we obtain with numerical
methods to the analytically constructed gates reported in
\cite{zhang2020universal} for the same device.

The optimization problem takes the form:
\begin{mini!}[2]
  {x_{0:N}, u_{0:N\text{-}1}}{\sum_{k=1}^N \norm{x_k\text{-}x_f}_{Q_k}
    + \sum_{k=1}^{N-1} \norm{u_k}_{R_k}}{}{} \label{eq:costfun}
    \addConstraint{x_{k+1}}{= f(x_k, u_k)}  \label{eq:dyn_con}
    \addConstraint{(x_1, x_N \; \textrm{given})}
    \addConstraint{g_k(x_k,u_k)}{\leq 0}
    \addConstraint{h_k(x_k,u_k)}{=0}
\end{mini!}
where the augmented state and controls are given by:
\begin{equation}
  x = \begin{bmatrix} \psi^{(1)} \\ \psi^{(2)} \\ \int a \ dt\\ a \\ \pdv*{a}{t} \end{bmatrix} \quad
  u = \begin{bmatrix} \pdv*[2]{a}{t} \end{bmatrix}
  \label{eq:astatecontrols}
\end{equation}
The initial and final conditions are determined by the
desired unitary transformation, which requires two quantum states
to specify $\psi^{(1)}$, $\psi^{(2)}$.
The ALTRO implementation we use does not currently support complex numbers so
we compute in the isomorphism $\mathcal{H}(\mathbb{R}^{2n}) \cong \mathcal{H}(\mathbb{C}^{n})$
given in \cite{leung2017speedup}:
\begin{equation}
  H \psi \cong \begin{bmatrix} H_{\textrm{re}} & -H_{\textrm{im}} \\ H_{\textrm{im}} & H_{\textrm{re}}\end{bmatrix}
  \begin{bmatrix} \psi_{\textrm{re}} \\ \psi_{\textrm{im}}\end{bmatrix}
\end{equation}
The discrete dynamics function $f(x_{k}, u_{k})$ integrates the TDSE dynamics for the quantum states
\eqref{eq:tdse}, \eqref{eq:hamiltonian}
and integrates the moments of the flux drive amplitude. Exposing lower order moments of the flux
drive amplitude allows us to penalize their norms, smoothing the flux drive amplitude
and mitigating AWG ringing due to high frequency transitions.
The matrices $Q_{k}$ and $R_{k}$ define the penalty metric. We choose $Q$
to be diagonal because it is computationally efficient. This corresponds
to penalizing phase differences between the quantum states, although
other phase-insensitive metrics such as infidelity may be employed.
The final state transfer is the most important objective which is
encoded in the realtive metric weight $Q_{N} \sim N \cdot Q_{k}$.

In addition to imposing optimization constraints that
reflect physical limitations of the apparatus, we impose
constraints that improve the experimental realization of the control pulse.
To ensure gates may be concatenated arbitrarily without
inducing AWG ringing due to high-frequency transitions,
we require $a(t = 0) = a(t = t_{N}) = 0$.
Furthermore, we require $\int_{0}^{t_{N}} a(t) dt = 0$. This
constraint ensures the pulse has zero net flux, mitigating
the hysteresis ubiquitous in flux bias lines,
\cite{battistel2019fast, krantz2019quantum, zhang2020universal}.
We require $-0.5 \textrm{GHz} \le a(t) \le 0.5 \textrm{GHz}$
to ensure the two-level approximation \eqref{eq:hamiltonian}
remains valid. Additionally, we require that each gate achieves
the desired state transition $\psi_{N} = \psi_{f}$.
Both the zero net flux and target quantum state constraint
are then handled by ensuring the target augmented state is
reached $x_{N} = x_{f}$, the constraint function
takes the form
$c_{k} = (x_{k} - x_{f})^{T}(x_{k} - x_{f})$.
The equality and inequality constraints on $a$ are handled
with a bound constraint which takes the form
$c_{k} = (x_{k} - b)^{T}(x_{k} - b)$ if $\lvert x_{k} \rvert \ge b$
and $0$ otherwise.
In addition the norm of the quantum states
are constrained to $1$ to ensure discretization error is not
exploited $c_{k} = x_{k}^{T}x_{k} - 1$.

%% In addition to obeying experimental constraints
%% and achieving low simulated gate errors, we desire
%% to make our gates perform well in the presence of decoherence.
%% Decoherence of the quantum state due to external noise
%% is modeled by two phenomena: longitudinal relaxation and pure dephasing.
%% They are modeled using their $1/e$ decay times $T_{1}$ and $T_{\phi}$ respectively.
%% Dissipation to the thermal bath via longitudinal
%% relaxation is an irreversible process
%% that results in information loss.
%% Converesely, pure dephasing is a reversible process.
%% We choose to maximize the longitudinal relaxation time directly
%% by tuning the flux amplitude, as in Section \ref{sec:longitude}, and
%% employ robust control techniques to mitigate
%% pure dephasing in Section \ref{sec:stochastic}.

%% The main contributions to longitudinal relaxation in our
%% device are dielectric loss in the capacitor, resistive loss in the inductor,
%% and Purcell loss. The main contributions to pure dephasing in our
%% device are $1/f$ flux noise and decay via charge and flux coupling
%% to the control lines.
%% Our device achieves its best pure dephasing
%% protection at the flux frustration point
%% $T_{2e}(a = 0) \sim 300 \mu\textrm{s}$
%% where the qubit is first-order insensitive to changes in flux.
%% It becomes more succeptable to pure dephasing as the flux is tuned away from the flux
%% frustration point $|a| > 0$. Conversely, longitudinal relaxation is at a minimum
%% at the flux frustration point $T_{1}(a = 0) = 0.315$ms,
%% and increases away from the flux frustration point
%% $T_{1}(a = 0.34 \textrm{GHz}) = 4.3$ms. Given the nature
%% of the decay processes and the tradeoff, 
