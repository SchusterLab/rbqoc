\section{Unscented Sampling Method}
\label{appendix:unscented}
In this section, we outline the full unscented sampling procedure.
We consider a state $\psi \in \mathbb{R}^{2n}$, 
an uncertain set of parameters $\lambda\in \mathbb{R}^{d}$, and discrete dynamics
$\psi_{k + 1} = f(\psi_{k}, \lambda_{k})$.
We abandon bra-ket notation to emphasize that
the state is a real vector, and it is given by the right-hand-side of the
complex-to-real isomorphism \eqref{eq:isomorphism}.
The nominal initial state is given by $\bar{\psi}_{1}$ with an associated
covariance matrix $P_{1} \in \mathbb{S}_{++}^{2n}$
\textcolor{blue}{[why do we need a double plus?]}
\textcolor{red}{[the convention is $+ =$ positive-semidefinite, $++ =$ positive-definite]}
which describes the uncertainty in the initial state.
We use the notation $\mathbb{S}_{++}^{m}$ to denote the
set of real, symmetric, and positive-definite $m \times m$ matrices.
By the positive-definite requirement, $P_{1}$ must be non-zero even if the state-preparation error
is negligible.
The uncertain parameter has zero-mean
and its distribution is given by the covariance matrix
$L_{k} \in \mathbb{S}_{++}^{d}$ at time step $k$. The zero-mean assumption
is convenient for deriving the update procedure. A non-zero mean can be encoded
in the discrete dynamics function $f(\psi_{k}, \lambda_{k})$.

The initial $4n + 2d$ sample states and initial $4n + 2d$
uncertain parameters are sampled from the initial distributions,
\begin{equation}\label{eq:uupdate}
  \begin{bmatrix} \psi_{1}^{j} \\ \lambda_{1}^{j} \end{bmatrix} =
  \begin{bmatrix} \bar{\psi}_{1} \\ 0\end{bmatrix}
    \pm \beta \sqrt{\begin{bmatrix} P_{1} & 0\\ 0 & L_{1}\end{bmatrix}}^{\; j}.
\end{equation}
$\beta$ is a hyperparameter that controls the spacing of the covariance contour.
The $(\pm)$ is understood to take $(+)$ for $j \in \{1, \dots, 2n + d\}$ and $(-)$ for
$j \in \{2n + d + 1, \dots, 4n + 2d\}$. We use the Cholesky factorization
to compute the square root of the
joint covariance matrix, though other methods
such as the principal square root may be employed.
The superscript on the matrix square root indicates the $j$\textsuperscript{th}
column (mod $2n + d$) of the lower triangular Cholesky factor.
Then, the sample states are normalized,
\begin{equation}\label{eq:unormalize}
  \psi_{1}^{j} \rightarrow \frac{\psi_{1}^{j}}{\sqrt{{\psi_{1}^{j}}^{T} \psi_{1}^{j}}}.
\end{equation}
The sample states are propagated to the next time step,
\begin{equation}\label{eq:upropagate}
  \psi^{j}_{2} = f(\psi^{j}_{1}, \lambda^{j}_{1}).
\end{equation}
The mean and covariance of the sample states are computed,
\begin{align}
  \bar{\psi}_{2} &= \frac{1}{4n + 2d} \sum_{j = 1}^{4n + 2d} \psi_{2}^{j},\\
  P_{2} &= \frac{1}{2 \beta^{2}} \sum_{j = 1}^{4n + 2d}
  (\psi^{j}_{2} - \bar{\psi}_{2})(\psi^{j}_{2} - \bar{\psi}_{2})^{T}.
\end{align}
The sample states are then resampled and propagated to the next time step using
\eqref{eq:uupdate}, \eqref{eq:unormalize}, and \eqref{eq:upropagate}. Our
choice of sample states (sigma points) follows equation 11 of
\cite{julier2004unscented}.
Prescriptions that require fewer sigma points exist \cite{julier2002reduced}.




